(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[920],{3047:(e,a,t)=>{Promise.resolve().then(t.bind(t,6549))},6549:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>i});var s=t(5155),l=t(2115),r=t(2728),d=t(5683),n=t(6046);let i=()=>{let e=(0,n.useRouter)(),[a,t]=(0,l.useState)("playing"),[i,o]=(0,l.useState)(100),[c,h]=(0,l.useState)(0),[u,x]=(0,l.useState)(0),[g,m]=(0,l.useState)(0),[b,p]=(0,l.useState)([]),[f,y]=(0,l.useState)([]),[v,j]=(0,l.useState)([]),[N,w]=(0,l.useState)([]),[k,P]=(0,l.useState)(1),[C,S]=(0,l.useState)(null),[M,R]=(0,l.useState)({x:0,y:0}),B=(0,l.useRef)(),I=(0,l.useRef)(0),z=(0,l.useRef)(0),D=(0,l.useRef)(0),E=[{x:0,y:300},{x:200,y:300},{x:200,y:150},{x:400,y:150},{x:400,y:450},{x:600,y:450},{x:600,y:300},{x:800,y:300}],H=(0,l.useCallback)(()=>{let e=[{health:50,speed:2,reward:10,color:"bg-red-500"},{health:80,speed:1.5,reward:15,color:"bg-red-700"},{health:30,speed:3,reward:8,color:"bg-red-300"},{health:120,speed:1,reward:25,color:"bg-red-900"}],a=Math.min(Math.floor(k/3),e.length-1),t=e[a],s={id:Date.now()+Math.random(),x:E[0].x,y:E[0].y,pathIndex:0,health:t.health,maxHealth:t.health,speed:t.speed,reward:t.reward,color:t.color};j(e=>[...e,s])},[k]),L=(e,a)=>{if(i<50)return;let t=50*e+25,s=50*a+25;if(E.some(e=>50>Math.abs(e.x-t)&&50>Math.abs(e.y-s)))return;let l=f.find(e=>25>Math.abs(e.x-t)&&25>Math.abs(e.y-s));if(l){$(l,{stopPropagation:()=>{}});return}S(null);let r={id:Date.now(),x:t,y:s,lastShot:0,range:80,damage:25,level:1,fireRate:500,upgradeHistory:[],availablePaths:["damage","range","speed"],lockedPath:null};y(e=>[...e,r]),o(e=>e-50)},O=(e,a)=>{let t=f.find(a=>a.id===e);t&&!(t.level>=5)&&!(i<75)&&t.availablePaths.includes(a)&&(y(t=>t.map(t=>{if(t.id===e){let e={};"damage"===a?e={damage:t.damage+20,range:t.range+5,fireRate:t.fireRate+25}:"range"===a?e={damage:t.damage+5,range:t.range+25,fireRate:t.fireRate+10}:"speed"===a&&(e={damage:t.damage+10,range:t.range+10,fireRate:Math.max(t.fireRate-75,100)});let s=[...t.upgradeHistory];s.push(a);let l=[...new Set(s)],r=[...t.availablePaths],d=t.lockedPath;if(2===l.length&&!t.lockedPath){let e=["damage","range","speed"].find(e=>!l.includes(e));e&&(r=r.filter(a=>a!==e),d=e)}return{...t,level:t.level+1,upgradeHistory:s,availablePaths:r,lockedPath:d,...e}}return t})),o(e=>e-75),S(null))},$=(e,a)=>{a.stopPropagation(),e.level>=5||(S(e),R({x:e.x+50,y:e.y}))},_=(0,l.useCallback)(()=>{let e=Date.now();e-z.current>1e3&&(o(e=>e+5),z.current=e);let a=Math.max(800-50*k,200);e-I.current>a&&(H(),I.current=e),j(e=>e.map(e=>{if(e.pathIndex>=E.length-1)return m(e=>e+1),null;let a=E[e.pathIndex+1],t=a.x-e.x,s=a.y-e.y,l=Math.sqrt(t*t+s*s),r=e.x,d=e.y,n=e.pathIndex;return l<3*e.speed?++n<E.length&&(r=E[n].x,d=E[n].y):(r+=t/l*e.speed,d+=s/l*e.speed),{...e,x:r,y:d,pathIndex:n}}).filter(Boolean)),y(a=>a.map(a=>{let t=v.find(e=>{let t=e.x-a.x,s=e.y-a.y;return Math.sqrt(t*t+s*s)<=a.range});return t&&e-a.lastShot>a.fireRate?(w(e=>[...e,{id:Date.now()+Math.random(),x:a.x,y:a.y,targetX:t.x,targetY:t.y,targetId:t.id,damage:a.damage,speed:5}]),{...a,lastShot:e}):a})),w(e=>e.map(e=>{let a=e.targetX-e.x,t=e.targetY-e.y,s=Math.sqrt(a*a+t*t);return s<e.speed?(j(a=>a.map(a=>{if(a.id===e.targetId){let t=a.health-e.damage;return t<=0?(o(e=>e+a.reward),h(e=>e+1),null):{...a,health:t}}return a}).filter(Boolean)),null):{...e,x:e.x+a/s*e.speed,y:e.y+t/s*e.speed}}).filter(Boolean))},[v,f,k,H]);(0,l.useEffect)(()=>{if("playing"===a)return B.current=setInterval(_,16),()=>clearInterval(B.current)},[_,a]),(0,l.useEffect)(()=>{D.current=c},[c]),(0,l.useEffect)(()=>{g>=10&&"playing"===a&&(x(D.current),t("gameOver"),setTimeout(()=>{e.push("/")},3e3))},[g,a,e]),(0,l.useEffect)(()=>{let e=setInterval(()=>{P(e=>e+1)},15e3);return()=>clearInterval(e)},[]);let T=e=>{let a=[...new Set(e.upgradeHistory)];if(a.length>0){if(a.includes("damage")&&a.includes("range"))return"bg-purple-600 border-purple-800";if(a.includes("damage")&&a.includes("speed"))return"bg-orange-600 border-orange-800";if(a.includes("range")&&a.includes("speed"))return"bg-teal-600 border-teal-800";if(a.includes("damage"))return"bg-red-600 border-red-800";else if(a.includes("range"))return"bg-blue-600 border-blue-800";else if(a.includes("speed"))return"bg-yellow-600 border-yellow-800"}return"bg-gray-600 border-gray-800"};return"gameOver"===a?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-red-900 text-white",children:(0,s.jsxs)(r.P.div,{initial:{scale:0},animate:{scale:1},className:"text-center bg-black bg-opacity-75 p-8 rounded-lg",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold mb-4",children:"Game Over!"}),(0,s.jsxs)("p",{className:"text-2xl mb-2",children:["Final Score: ",u]}),(0,s.jsx)("p",{className:"text-lg",children:"Returning to hub in 3 seconds..."})]})}):(0,s.jsxs)("div",{className:"min-h-screen bg-green-800 p-4",onClick:()=>{S(null)},children:[(0,s.jsx)("div",{className:"absolute top-4 left-4 z-50",children:(0,s.jsxs)("button",{onClick:()=>{e.push("/")},className:"flex items-center gap-2 px-4 py-2 bg-white bg-opacity-90 hover:bg-opacity-100 border border-gray-300 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 text-gray-700 hover:text-gray-900",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"Back to Hub"})]})}),(0,s.jsxs)("div",{className:"mb-4 flex justify-between items-center text-white",children:[(0,s.jsxs)("div",{className:"flex space-x-6",children:[(0,s.jsxs)("div",{children:["Currency: $",i]}),(0,s.jsxs)("div",{children:["Score: ",c]}),(0,s.jsxs)("div",{children:["Wave: ",k]}),(0,s.jsxs)("div",{children:["Lives: ",10-g]})]}),(0,s.jsxs)("div",{className:"text-right text-sm",children:[(0,s.jsx)("div",{className:"font-bold mb-1",children:"Tower Colors"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,s.jsx)("div",{className:"w-4 h-4 bg-gray-600 border border-gray-800 rounded"}),(0,s.jsx)("span",{children:"New Tower"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,s.jsx)("div",{className:"w-4 h-4 bg-red-600 border border-red-800 rounded"}),(0,s.jsx)("span",{children:"Damage Focus"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,s.jsx)("div",{className:"w-4 h-4 bg-blue-600 border border-blue-800 rounded"}),(0,s.jsx)("span",{children:"Range Focus"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-4 h-4 bg-yellow-600 border border-yellow-800 rounded"}),(0,s.jsx)("span",{children:"Speed Focus"})]})]})]}),(0,s.jsxs)("div",{className:"relative bg-green-600 border-4 border-green-900 mx-auto",style:{width:800,height:600},children:[(0,s.jsx)("svg",{className:"absolute inset-0 pointer-events-none z-0",children:(0,s.jsx)("path",{d:"M ".concat(E.map(e=>"".concat(e.x," ").concat(e.y)).join(" L ")),stroke:"#8B4513",strokeWidth:"40",fill:"none"})}),(()=>{let e=[];for(let a=0;a<12;a++)for(let t=0;t<16;t++)e.push((0,s.jsx)("div",{className:"absolute border border-gray-300 hover:bg-blue-100 cursor-pointer opacity-50 z-10",style:{left:50*t,top:50*a,width:50,height:50},onClick:e=>{e.stopPropagation(),L(t,a)}},"".concat(t,"-").concat(a)));return e})(),(0,s.jsx)(d.N,{children:f.map(e=>{let a=T(e);return(0,s.jsxs)(r.P.div,{initial:{scale:0},animate:{scale:1},className:"absolute ".concat(a," rounded-full cursor-pointer hover:scale-110 transition-all duration-300 z-20"),style:{left:e.x-15,top:e.y-15,width:30,height:30},onClick:a=>$(e,a),children:[(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-white font-bold text-xs z-30",children:e.level}),(0,s.jsx)("div",{className:"absolute border border-blue-400 rounded-full opacity-20 pointer-events-none z-0",style:{left:-e.range+15,top:-e.range+15,width:2*e.range,height:2*e.range}})]},"".concat(e.id,"-").concat(e.upgradeHistory.join("-")))})}),(0,s.jsx)(d.N,{children:v.map(e=>(0,s.jsx)(r.P.div,{className:"absolute ".concat(e.color," rounded-full border border-black z-15"),style:{left:e.x-10,top:e.y-15,width:20,height:20},initial:{scale:0},animate:{scale:1},exit:{scale:0},children:(0,s.jsx)("div",{className:"absolute -top-4 left-0 w-full h-2 bg-red-800 rounded z-16 border border-black",children:(0,s.jsx)("div",{className:"h-full bg-green-400 rounded transition-all duration-200",style:{width:"".concat(Math.max(0,e.health/e.maxHealth*100),"%")}})})},e.id))}),(0,s.jsx)(d.N,{children:N.map(e=>(0,s.jsx)(r.P.div,{className:"absolute bg-yellow-400 rounded-full z-15",style:{left:e.x-2,top:e.y-2,width:4,height:4},initial:{scale:0},animate:{scale:1},exit:{scale:0}},e.id))}),C&&(0,s.jsxs)(r.P.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},className:"absolute bg-black bg-opacity-90 text-white p-4 rounded-lg border border-gray-600 z-50",style:{left:Math.min(M.x,550),top:Math.min(M.y,380)},onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("h3",{className:"text-lg font-bold mb-3",children:["Upgrade Tower (Level ",C.level,")"]}),C.lockedPath&&(0,s.jsxs)("div",{className:"text-xs mb-3 text-red-400",children:[C.lockedPath.charAt(0).toUpperCase()+C.lockedPath.slice(1)," path locked after choosing 2 different paths"]}),(0,s.jsxs)("div",{className:"text-xs mb-3 text-gray-300",children:["Upgrade history: ",C.upgradeHistory.length>0?C.upgradeHistory.join(", "):"None"]}),(0,s.jsxs)("div",{className:"space-y-2",children:[C.availablePaths.includes("damage")&&(0,s.jsxs)("button",{className:"w-full bg-red-600 hover:bg-red-700 p-2 rounded text-sm transition-colors disabled:opacity-50",onClick:()=>O(C.id,"damage"),disabled:i<75,children:[(0,s.jsxs)("div",{className:"font-bold",children:["Damage Branch ($",75,")"]}),(0,s.jsx)("div",{className:"text-xs",children:"+20 damage, +5 range, +25 fire rate"})]}),!C.availablePaths.includes("damage")&&"damage"===C.lockedPath&&(0,s.jsxs)("button",{className:"w-full bg-gray-500 p-2 rounded text-sm opacity-50 cursor-not-allowed",disabled:!0,children:[(0,s.jsx)("div",{className:"font-bold",children:"Damage Branch - LOCKED"}),(0,s.jsx)("div",{className:"text-xs",children:"Choose 2 different paths to lock the third"})]}),C.availablePaths.includes("range")&&(0,s.jsxs)("button",{className:"w-full bg-blue-600 hover:bg-blue-700 p-2 rounded text-sm transition-colors disabled:opacity-50",onClick:()=>O(C.id,"range"),disabled:i<75,children:[(0,s.jsxs)("div",{className:"font-bold",children:["Range Branch ($",75,")"]}),(0,s.jsx)("div",{className:"text-xs",children:"+25 range, +5 damage, +10 fire rate"})]}),!C.availablePaths.includes("range")&&"range"===C.lockedPath&&(0,s.jsxs)("button",{className:"w-full bg-gray-500 p-2 rounded text-sm opacity-50 cursor-not-allowed",disabled:!0,children:[(0,s.jsx)("div",{className:"font-bold",children:"Range Branch - LOCKED"}),(0,s.jsx)("div",{className:"text-xs",children:"Choose 2 different paths to lock the third"})]}),C.availablePaths.includes("speed")&&(0,s.jsxs)("button",{className:"w-full bg-yellow-600 hover:bg-yellow-700 p-2 rounded text-sm transition-colors disabled:opacity-50",onClick:()=>O(C.id,"speed"),disabled:i<75,children:[(0,s.jsxs)("div",{className:"font-bold",children:["Speed Branch ($",75,")"]}),(0,s.jsx)("div",{className:"text-xs",children:"-75 fire rate, +10 damage, +10 range"})]}),!C.availablePaths.includes("speed")&&"speed"===C.lockedPath&&(0,s.jsxs)("button",{className:"w-full bg-gray-500 p-2 rounded text-sm opacity-50 cursor-not-allowed",disabled:!0,children:[(0,s.jsx)("div",{className:"font-bold",children:"Speed Branch - LOCKED"}),(0,s.jsx)("div",{className:"text-xs",children:"Choose 2 different paths to lock the third"})]})]}),(0,s.jsxs)("div",{className:"mt-3 text-xs text-gray-300",children:["Current: ",C.damage," dmg, ",C.range," range, ",C.fireRate,"ms"]})]})]}),(0,s.jsxs)("div",{className:"mt-4 text-white text-center",children:[(0,s.jsxs)("p",{children:["Click on empty tiles to place towers ($",50," each) | Click on towers to open upgrade menu ($",75," each)"]}),(0,s.jsx)("p",{children:"Choose any upgrade paths, but after picking 2 different paths, the third becomes locked!"}),(0,s.jsx)("p",{children:"Tower colors change based on chosen upgrade paths. Plan your strategy carefully!"})]})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[465,441,517,358],()=>a(3047)),_N_E=e.O()}]);